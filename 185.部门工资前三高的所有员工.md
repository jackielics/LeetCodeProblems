# Problem
[185. Department Top Three Salaries]

# Key Intuition
1. use PARTION BY to RANK() in groups, use DENSE_RANK() or GROUP BY & RANK() to rank salary only

# Code
```sql
SELECT  Department, 
        Employee, 
        Salary 
FROM 
    (SELECT  d.name AS `Department`, 
            e.name AS `Employee`, 
            salary AS `Salary`, 
            DENSE_RANK() OVER (PARTITION BY departmentId ORDER BY salary DESC) AS `rk`
    FROM    Employee e
            LEFT JOIN Department d
            ON d.id = e.departmentId) AS t
WHERE rk <= 3
```

```sql
# Write your MySQL query statement below

select 
    subq.name as Department,
    e.name as Employee,
    e.salary as Salary
from
    Employee e,
    (select 
        d.name,
        e.departmentId,
        salary,
        rank() over (partition by departmentId order by salary desc) as rk
    from Employee e
    left join Department d
    on e.departmentId = d.id
    group by departmentId, d.name, salary
    ) subq
where 
    e.departmentId = subq.departmentId
    and e.salary = subq.salary
    and subq.rk <= 3
```